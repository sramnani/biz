"use strict";angular.module("outingzApp",["chieffancypants.loadingBar","ngAnimate","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","ui.utils","ui.bootstrap","ngAside","ngCookies"]).config(["$routeProvider","$httpProvider",function($routeProvider,$httpProvider){$routeProvider.when("/",{title:"Dashboard here",templateUrl:"views/dashboard.html",controller:"MerchantCtrl",resolve:{authenticated:["$q","$location","UserService",function($q,$location,UserService){var deferred=$q.defer();return UserService.isAuthenticated()?deferred.resolve():$location.path("/login"),deferred.promise}]}}).when("/merchant/:resetMessage",{title:"Settings, Business Setup",templateUrl:"views/merchant.html",controller:"MerchantCtrl",resolve:{authenticated:["$q","$location","UserService",function($q,$location,UserService){var deferred=$q.defer();return UserService.isAuthenticated()?deferred.resolve():$location.path("/login"),deferred.promise}]}}).when("/merchant",{title:"Settings, Business Setup",templateUrl:"views/merchant.html",controller:"MerchantCtrl",resolve:{authenticated:["$q","$location","UserService",function($q,$location,UserService){var deferred=$q.defer();return UserService.isAuthenticated()?deferred.resolve():$location.path("/login"),deferred.promise}]}}).when("/location",{title:"Settings, Business Setup",templateUrl:"views/location.html",controller:"MerchantCtrl",resolve:{authenticated:["$q","$location","UserService",function($q,$location,UserService){var deferred=$q.defer();return UserService.isAuthenticated()?deferred.resolve():$location.path("/login"),deferred.promise}]}}).when("/activity_service",{title:"Add Activity",templateUrl:"views/activity_service.html",controller:"ServiceCtrl",resolve:{authenticated:["$q","$location","UserService",function($q,$location,UserService){var deferred=$q.defer();return UserService.isAuthenticated()?deferred.resolve():$location.path("/login"),deferred.promise}]}}).when("/activity_class",{title:"Add Activity",templateUrl:"views/activity_class.html",controller:"ClassCtrl",resolve:{authenticated:["$q","$location","UserService",function($q,$location,UserService){var deferred=$q.defer();return UserService.isAuthenticated()?deferred.resolve():$location.path("/login"),deferred.promise}]}}).when("/customer",{title:"Add Customer",templateUrl:"views/customer.html",controller:"CustomerCtrl",resolve:{authenticated:["$q","$location","UserService",function($q,$location,UserService){var deferred=$q.defer();return UserService.isAuthenticated()?deferred.resolve():$location.path("/login"),deferred.promise}]}}).when("/activity_test",{title:"Add Activity",templateUrl:"views/activity_class_test.html",controller:"ServiceCtrl",resolve:{authenticated:["$q","$location","UserService",function($q,$location,UserService){var deferred=$q.defer();return UserService.isAuthenticated()?deferred.resolve():$location.path("/login"),deferred.promise}]}}).when("/reset_password/:resetPassword/:key/:username/:token*",{title:"Reset your password",templateUrl:"views/reset-password.html",controller:"userCtrl"}).when("/login",{title:"Login",templateUrl:"views/login.html",controller:"userCtrl",resolve:{authenticated:["$q","$location","UserService",function($q,$location,UserService){var deferred=$q.defer();return UserService.isAuthenticated()?$location.path("/"):deferred.resolve(),deferred.promise}]}}).when("/logout",{templateUrl:"views/login.html",controller:"userCtrl"}).when("/register",{title:"Invite Business",templateUrl:"views/register.html",controller:"userCtrl"}).when("/buildInfo",{title:"Your build info",templateUrl:"views/build.html",controller:"buildCtrl"}).when("/test",{title:"Test here",templateUrl:"views/test.html",controller:"simpleCtrl"}).when("/forgotPassword",{title:"Test here",templateUrl:"views/test.html",controller:"userCtrl"}).when("/paypal",{title:"Paypal Payment",templateUrl:"views/paypal.html",controller:"userCtrl"}).otherwise({redirectTo:"/"}),$httpProvider.interceptors.push(["$q","$window","$location","$cookies",function($q,$window,$location,$cookies){return{request:function(config){var token=$cookies.token,key=$cookies.keyy,header={key:key,token:token},header_string=JSON.stringify(header);return token?config.headers.Authorization=header_string:console.log("No header found"),config},responseError:function(response){return $q.reject(response)},response:function(response){return response}}}])}]).directive("hoverBgImage",function(){return{link:function(scope,elm,attrs){elm.bind("mouseenter",function(){this.src=attrs.hoverBgImage}),elm.bind("mouseleave",function(){this.src=attrs.data})}}}).directive("onlyDigits",function(){return{restrict:"A",require:"?ngModel",link:function(scope,element,attrs,ngModel){ngModel&&ngModel.$parsers.unshift(function(inputValue){var digits=inputValue.replace(/\D/g,"");return attrs.time?((1>digits||digits>12)&&(digits=1),""==digits&&(digits=1),ngModel.$viewValue=digits):ngModel.$viewValue=digits,ngModel.$render(),digits})}}}).directive("datepickerPopup",function(){return{restrict:"EAC",require:"ngModel",link:function(scope,element,attr,controller){controller.$formatters.shift()}}}).run(["$location","$rootScope","$http",function($location,$rootScope){$rootScope.$on("$routeChangeSuccess",function(event,current){$rootScope.title=current.$$route.title})}]),angular.module("outingzApp").controller("MerchantCtrl",["$scope","MerchantService","$q","$http","$routeParams","$location","$timeout","$cookies","UserService",function($scope,MerchantService,$q,$http,$routeParams,$location,$timeout,$cookies){$scope.image_bussiness="images/business_img.png",$scope.image_activity="images/activity_img.png",$scope.image_membership="images/membership_img.png",$scope.image_social="images/social_img.png",$scope.image_payment="images/payment_img.png",$scope.image_staff="images/staff_img.png",$scope.msg=!1,$routeParams.resetMessage?($scope.msg=!0,$scope.Reset_message="Password reset successfully"):($scope.msg=!1,$scope.Reset_message=$routeParams.resetMessage),$scope.merchant={},$scope.success="",$scope.error="",$scope.location={},$scope.location.address={},$scope.states=MerchantService.get_states(),$scope.countries=["USA"],$scope.loader=!1,$scope.loader_img="images/ajax-loader.gif",("/merchant"===$location.url()||"/location"===$location.url())&&($scope.loader=!0,MerchantService.get_merchat().then(function(data){$scope.loader=!1,$scope.merchant=data,"/location"===$location.url()&&($scope.location.locationName=$scope.merchant.primaryAddress.line2,$scope.location.address.line1=$scope.merchant.primaryAddress.line1,$scope.location.address.line2=$scope.merchant.primaryAddress.line2,$scope.location.address.state=$scope.merchant.primaryAddress.state,$scope.location.address.zip=$scope.merchant.primaryAddress.zip,$scope.location.address.city=$scope.merchant.primaryAddress.city,$scope.location.contactPerson={},$scope.location.contactPerson.name={},$scope.location.contactPerson.phone={},$scope.location.contactPerson.emailId={},$scope.location.contactPerson.name.firstName=$scope.merchant.primaryContactPerson.name.firstName,$scope.location.contactPerson.phone.number=$scope.merchant.primaryContactPerson.phone.number,$scope.location.contactPerson.emailId=$scope.merchant.primaryContactPerson.emailId)},function(){$scope.error="Error in creating your bussiness!"})),$scope.link_it=function(){$location.url("/activity_service")},$scope.create_merchant=function(merchant,isvalid){if(isvalid){$scope.location.locationName="Primary",merchant.locations={},merchant.locations.location=[],merchant.locations.location.push($scope.location);var key=$cookies.keyy;$scope.merchant.id=key,MerchantService.add_merchant(merchant).then(function(){$scope.success="Your Business setup sucessfully",$timeout(function(){$location.url("/location")},2e3)},function(){$scope.error="Error in creating your bussiness!"})}else $scope.showValidation=!0,$scope.error="Error in creating your bussiness!",$timeout(function(){$scope.error=!1,$scope.success=!1},3e3)},$scope.location={},$scope.locations_data=[],$scope.location.address={},$scope.location.locationSchedules={},$scope.location.locationSchedules.locationSchedules=[],$scope.add_merchant_location=function(locations,isvalid){isvalid?(locations.address.country="Secondary",angular.forEach($scope.locationSchedule,function(value){$scope.location.locationSchedules.locationSchedules.push(value)}),console.log(JSON.stringify($scope.location)),MerchantService.add_merchant_location(locations).then(function(){$scope.locations_data.push(locations),$scope.location={},$scope.location.address={},$scope.success="Your location added sucessfully"},function(){$scope.error="Error in saving your location!"})):($scope.showValidation=!0,$scope.error="Error in Adding your location!",$timeout(function(){$scope.error=!1,$scope.success=!1},3e3))},"/location"===$location.url()&&MerchantService.get_merchant_locations().then(function(data){$scope.locations_data=data.location},function(error){console.log("There is an error"+error)})}]),angular.module("outingzApp").controller("ServiceCtrl",["$scope","ActivityService","$q","$http","$location","$window","$route","$timeout","$cookies","$aside",function($scope,ActivityService,$q,$http,$location,$window,$route,$timeout,$cookies,$aside){$scope.service={},console.log("service"),$scope.select_type=function(obj){$location.path("service"==obj?"/activity_service":"/activity_class")},$scope.error="",$scope.success="",$scope.service.offering={},$scope.service.offering.duration="1 Hour",$scope.add_activity_service=function(activity_service,isvalid){isvalid?ActivityService.add_activity_service(activity_service).then(function(){$scope.success="Activity service added successfully",$timeout(function(){$scope.error=!1,$scope.success=!1,$scope.showValidation=!1},3e3)},function(error){console.log("There is an error"+error)}):($scope.showValidation=!0,$scope.error="Error in creating your bussiness!",$timeout(function(){$scope.error=!1,$scope.success=!1},3e3))},$scope.$on("myEvent",function(){console.log("my event occurred")}),$scope.openAside=function(position){$aside.open({templateUrl:"../../views/activity_aside.html",placement:position,backdrop:!0,controller:function($scope,$modalInstance,CustomerService,$filter,$rootScope){$scope.ok=function(e){$rootScope.$broadcast("myEvent"),console.log("OK"),$modalInstance.close(),e.stopPropagation()},$scope.cancel=function(e){$modalInstance.dismiss(),e.stopPropagation()},$scope.open_since=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.opened_since=!0},$scope.open=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.opened=!0},$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.formats=["dd-MMMM-yyyy","yyyy/MM/dd","MM/dd/yy","shortDate"],$scope.format=$scope.formats[2],$scope.success="",$scope.error="",$scope.showValidation=!1,$scope.customer={},$scope.create_customer=function(customer,isvalid){isvalid?(console.log(JSON.stringify(customer.startDate)),CustomerService.add_customer(customer).then(function(){$scope.success="Your Customer added sucessfully"},function(){$scope.error="Error in creating your Customer!"})):($scope.showValidation=!0,$scope.error="Error in creating your bussiness!",$timeout(function(){$scope.error=!1,$scope.success=!1},3e3))}}})}}]),angular.module("outingzApp").controller("ClassCtrl",["$scope","ActivityService","$q","$http","$location","$window","$route","$timeout","$cookies",function($scope,ActivityService,$q,$http,$location,$window,$route,$timeout){console.log("class"),$scope.states=["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],$scope.select_type=function(obj){$location.path("service"==obj?"/activity_service":"/activity_class")},$scope.add_activity_class=function(activity_class,isvalid){isvalid?ActivityService.add_activity_class(activity_class).then(function(){$scope.success="Activity Class added successfully",$timeout(function(){$scope.error=!1,$scope.success=!1,$scope.showValidation=!1},3e3)},function(error){console.log("There is an error"+error)}):($scope.showValidation=!0,$scope.error="Error in adding your class!",$timeout(function(){$scope.error=!1,$scope.success=!1},3e3))}}]),angular.module("outingzApp").controller("userCtrl",["$scope","$q","$http","$routeParams","$location","$window","$cookies","UserService",function($scope,$q,$http,$routeParams,$location,$window,$cookies,UserService){$scope.password="",$scope.success="",$scope.error="";$scope.register=function(registerObj){registerObj.id="id"+Math.floor(9999999999*Math.random()+1),console.log(JSON.stringify(registerObj)),UserService.register(registerObj).then(function(data){console.log(JSON.stringify(data)),500==data.status?$scope.error="Error in registeration":data.id?($scope.success="An Invitation email has been sent to the user to generate the password and activate account",window.setTimeout(function(){$(".alert-message").alert("close")},2e3),$scope.merchant={}):$scope.error="Error while sending Invitation!"},function(error){console.log("There is an error"+error)})},$scope.login=function(){var loginObj={};loginObj.username=$scope.username,loginObj.password=$scope.password,UserService.login(loginObj).then(function(data){console.log(JSON.stringify(data)),500==data.status?$scope.error="Wrong username & password":($cookies.token=data.data.token,$cookies.keyy=data.data.key,$location.url("/merchant"))},function(error){console.log("There is an error"+error)})},$scope.username="",$scope.username=$routeParams.username,$scope.reset_password=function(){var reset_obj={};reset_obj.user=$routeParams.username,reset_obj.key=$routeParams.key,reset_obj.password=$scope.password,UserService.reset_password(reset_obj).then(function(){var loginObj={};loginObj.username=$routeParams.username,loginObj.password=$scope.password,UserService.login(loginObj).then(function(data){console.log(JSON.stringify(data)),500==data.status?$scope.error="Wrong username & password":($cookies.token=data.data.token,$cookies.keyy=data.data.key,$scope.password="",$scope.confirmPassword="",$location.url("/merchant/reset"))})},function(){$scope.error="Error while resetting your password!"})}}]).controller("NavbarCtrl",["$scope","$q","$http","$routeParams","$location","$window","$cookies","UserService",function($scope,$q,$http,$routeParams,$location,$window,$cookies,UserService){$scope.isAuthenticated=function(){return UserService.isAuthenticated()},$scope.check=function(){return"/login"!=$location.path()?!0:!1},$scope.logout=function(){$cookies.token="false",$cookies.keyy="false",$location.url("/login")}}]),angular.module("outingzApp").controller("buildCtrl",["$scope","$q","$http","$routeParams","$location","$window","UserService",function($scope,$q,$http,$routeParams,$location){$http.get("views/build.json").success(function(data){$scope.build=data}),$scope.getImg=function(){return"/login"==$location.path()?!0:!1}}]),angular.module("outingzApp").controller("CustomerCtrl",["$scope","MerchantService","$q","$http","$routeParams","$location","$timeout","$aside","UserService","CustomerService","$filter","$rootScope",function($scope,MerchantService,$q,$http,$routeParams,$location,$timeout,$aside){$scope.$on("myEvent",function(){console.log("my event occurred")}),$scope.openAside=function(position){$aside.open({templateUrl:"../../views/aside.html",placement:position,backdrop:!0,controller:function($scope,$modalInstance,CustomerService,$filter,$rootScope,MerchantService){$scope.ok=function(e){$rootScope.$broadcast("myEvent"),console.log("OK"),$modalInstance.close(),e.stopPropagation()},$scope.cancel=function(e){$modalInstance.dismiss(),e.stopPropagation()},$scope.open_since=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.opened_since=!0},$scope.open=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.opened=!0},$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.formats=["dd-MMMM-yyyy","yyyy/MM/dd","MM/dd/yy","shortDate"],$scope.format=$scope.formats[2],$scope.success="",$scope.error="",$scope.showValidation=!1,$scope.customer={},$scope.states=MerchantService.get_states(),$scope.create_customer=function(customer,isvalid){isvalid?(console.log(JSON.stringify(customer.startDate)),customer.primaryAddress.country="USA",CustomerService.add_customer(customer).then(function(){$scope.success="Your Customer added sucessfully"},function(){$scope.error="Error in creating your Customer!"})):($scope.showValidation=!0,$scope.error="Error in creating your customer!",$timeout(function(){$scope.error=!1,$scope.success=!1},3e3))}}})}}]),angular.module("outingzApp").controller("simpleCtrl",["$scope",function($scope){$scope.setAddress=function(type,zip){console.log("Type: "+type+" "+zip)},$scope.copyAddress=function(){$scope.shippingZip=$scope.billingZip}}]),angular.module("outingzApp").factory("MerchantService",["$http","$q","$window","$cookies",function($http,$q,$window,$cookies){return{add_merchant:function(merchantObj){var deferred=$q.defer();return $http.post("https://api.outingz.com/outingz/merchants",merchantObj).success(function(data){deferred.resolve(data)}).error(function(){deferred.reject("An error occured while fetching items")}),deferred.promise},add_merchant_location:function(locationObj){var deferred=$q.defer(),key=$cookies.keyy;return $http.post("https://api.outingz.com/outingz/merchants/"+key+"/locations",locationObj).success(function(data){deferred.resolve(data)}).error(function(){deferred.reject("An error occured while fetching items")}),deferred.promise},get_merchant_locations:function(){var deferred=$q.defer(),key=$cookies.keyy;return $http.get("https://api.outingz.com/outingz/merchants/"+key+"/locations").success(function(data){deferred.resolve(data)}).error(function(){deferred.reject("An error occured while fetching items")}),deferred.promise},get_merchat:function(){var deferred=$q.defer(),key=$cookies.keyy;return $http.get("https://api.outingz.com/outingz/merchants/"+key).success(function(data){deferred.resolve(data)}).error(function(){deferred.reject("An error occured while fetching items")}),deferred.promise},get_states:function(){return["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"]}}}]),angular.module("outingzApp").factory("ActivityService",["$http","$q","$window","$cookies",function($http,$q,$window,$cookies){return{add_activity_service:function(activity_service){var deferred=$q.defer(),link="",key=$cookies.keyy;return link="https://api.outingz.com/outingz/merchants/"+key+"/services",$http.post(link,activity_service).success(function(data){deferred.resolve(data)}).error(function(){deferred.reject("An error occured while fetching items")}),deferred.promise},add_activity_class:function(activity_class){var deferred=$q.defer(),link="",key=$cookies.keyy;return link="https://api.outingz.com/outingz/merchants/"+key+"/classes",$http.post(link,activity_class).success(function(data){deferred.resolve(data)}).error(function(){deferred.reject("An error occured while fetching items")}),deferred.promise},register:function(){var deferred=$q.defer();return obj={},obj.id="id5941",obj.name="varun",obj.shortName="vipy",obj.primaryUserName="varunprashar5@gmail.com",obj.dba="vhelo",obj.companyUrl="companyUrl",$http.post("https://api.outingz.com/outingz/registration",obj).success(function(data){deferred.resolve(data)}).error(function(){deferred.reject("An error occured while fetching items")}),deferred.promise}}}]),angular.module("outingzApp").factory("UserService",["$http","$q","$window","$location","$cookies",function($http,$q,$window,$location,$cookies){return{reset_password:function(reset_obj){var deferred=$q.defer();return $http.post("https://api.outingz.com/outingz/authenticate/resetLogin",reset_obj).success(function(data){deferred.resolve(data)}).error(function(){deferred.reject("An error occured while fetching items")}),deferred.promise},login:function(loginObj){var deferred=$q.defer();return $http.post("https://api.outingz.com/outingz/authenticate",loginObj).success(function(data,status){deferred.resolve({data:data,status:status})}).error(function(){deferred.reject("An error occured while fetching items")}),deferred.promise},register:function(registerObj){var deferred=$q.defer();return $http.post("https://api.outingz.com/outingz/registration",registerObj).success(function(data){deferred.resolve(data)}).error(function(){deferred.reject("An error occured while fetching items")}),deferred.promise},isAuthenticated:function(){var token=$cookies.token,key=$cookies.keyy;return void 0==token&&void 0==key?!1:"false"!=token&&"false"!=key?!0:!1}}}]),angular.module("outingzApp").factory("CustomerService",["$http","$q","$window","$cookies",function($http,$q){return{add_customer:function(customerObj){var deferred=$q.defer();return $http.post("https://api.outingz.com/outingz/subscriber",customerObj).success(function(data){deferred.resolve(data)}).error(function(){deferred.reject("An error occured while fetching items")}),deferred.promise}}}]),angular.module("outingzApp").directive("validPasswordC",function(){return{require:"ngModel",scope:{otherModelValue:"=validPasswordC"},link:function(scope,element,attributes,ngModel){ngModel.$validators.compareTo=function(modelValue){return modelValue==scope.otherModelValue},scope.$watch("otherModelValue",function(){ngModel.$validate()})}}}),angular.module("outingzApp").directive("timePick",function(){return{restrict:"E",templateUrl:"../../views/timePicker.html",link:function(scope){function simpleKeys(original){return Object.keys(original).reduce(function(obj,key){return obj[key]="object"==typeof original[key]?"{ ... }":original[key],obj},{})}scope.error_directive="",scope.locationSchedule=[];{var locations=[];angular.element(document.querySelector(".timerpopup"))}scope.showPopover=!1,scope.flag=!1,scope.from=9,scope.to=5,scope.period=["AM","PM"],scope.from_type=scope.period[0],scope.to_type=scope.period[1],scope.disb=function(day){var myEl=angular.element(document.querySelector(".timerpopup"));return myEl.attr("day")&&myEl.attr("day")==day?!1:myEl.attr("day")?!0:void 0},scope.all_days=function(){scope.all},scope.current_day="",scope.showPop=function($event,pos,day){scope.error_directive="";var checkbox=$event.target;switch(day){case"MON":scope.current_day="Monday";break;case"TUE":scope.current_day="Tuesday";break;case"WED":scope.current_day="Wednesday";break;case"THU":scope.current_day="Thursday";break;case"FRI":scope.current_day="Friday";break;case"SAT":scope.current_day="Saturday";break;case"SUN":scope.current_day="Sunday"}var myEl=angular.element(document.querySelector(".timerpopup"));myEl.attr("day")?checkbox.checked||(scope.showPopover=!1,myEl.removeAttr("day")):(myEl.attr("day",day),scope.showPopover=!0,checkbox.checked||(scope.showPopover=!1,angular.forEach(scope.locationSchedule,function(value){value.day!=myEl.attr("day")&&locations.push(value)}),scope.locationSchedule=locations,locations=[],myEl.removeAttr("day")))},scope.showHover=function($event,pos,day){simpleKeys($event);switch(scope.error_directive="",day){case"MON":scope.current_day="Monday";break;case"TUE":scope.current_day="Tuesday";break;case"WED":scope.current_day="Wednesday";break;case"THU":scope.current_day="Thursday";break;case"FRI":scope.current_day="Friday";break;case"SAT":scope.current_day="Saturday";break;case"SUN":scope.current_day="Sunday"}var myEl=angular.element(document.querySelector(".timerpopup"));if(!myEl.attr("day")){scope.showPopover=!0;var keepGoing=!0;angular.forEach(scope.locationSchedule,function(value){keepGoing&&(value.day==day?(scope.from=parseInt(value.startTime.slice(0,-2)),scope.from_type=value.startTime.slice(-2),scope.to=parseInt(value.endTime.slice(0,-2)),scope.to_type=value.endTime.slice(-2),keepGoing=!1):(scope.from=9,scope.from_type="AM",scope.to=5,scope.to_type="PM"))})}},scope.closePop=function(obj){scope.error_directive="";var myEl=angular.element(document.querySelector(".timerpopup"));if(myEl.attr("day"))if(obj&&"close"==obj){switch(scope.showPopover=!1,myEl.attr("day")){case"MON":scope.mon=!1;break;case"TUE":scope.tue=!1;break;case"WED":scope.wed=!1;break;case"THU":scope.thu=!1;break;case"FRI":scope.fri=!1;break;case"SAT":scope.sat=!1;break;case"SUN":scope.sun=!1}myEl.removeAttr("day")}else scope.showPopover=!0;else scope.showPopover=!1,myEl.removeAttr("day")},scope.generateUUID=function(){var d=(new Date).getTime(),uuid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=(d+16*Math.random())%16|0;return d=Math.floor(d/16),("x"==c?r:3&r|8).toString(16)});return uuid},scope.save_time=function(){var myEl=angular.element(document.querySelector(".timerpopup")),guid=scope.generateUUID(),data={id:guid,endTime:scope.to+scope.to_type,startTime:scope.from+scope.from_type,day:myEl.attr("day")};if(""==scope.to)return void(scope.error_directive="Please select to & from time");if(""==scope.from)return void(scope.error_directive="Please select to & from time");if(scope.from<1||scope.from>12)return void(scope.error_directive="Time should be between 1 to 12");if(scope.to<1||scope.to>12)return void(scope.error_directive="Time should be between 1 to 12");if(""==scope.from_type)return void(scope.error_directive="Please select AM or PM for FROM");if(""==scope.to_type)return void(scope.error_directive="Please select AM or PM for TO");if(scope.error_directive="",scope.all){scope.locationSchedule=[];var guid=scope.generateUUID();scope.locationSchedule.push({id:scope.generateUUID(),endTime:scope.to+scope.to_type,startTime:scope.from+scope.from_type,day:myEl.attr("day")}),"MON"!=myEl.attr("day")&&(scope.locationSchedule.push({id:scope.generateUUID(),endTime:scope.to+scope.to_type,startTime:scope.from+scope.from_type,day:"MON"}),scope.mon=!0),"TUE"!=myEl.attr("day")&&(scope.locationSchedule.push({id:scope.generateUUID(),endTime:scope.to+scope.to_type,startTime:scope.from+scope.from_type,day:"TUE"}),scope.tue=!0),"WED"!=myEl.attr("day")&&(scope.locationSchedule.push({id:scope.generateUUID(),endTime:scope.to+scope.to_type,startTime:scope.from+scope.from_type,day:"WED"}),scope.wed=!0),"THU"!=myEl.attr("day")&&(scope.locationSchedule.push({id:scope.generateUUID(),endTime:scope.to+scope.to_type,startTime:scope.from+scope.from_type,day:"THU"}),scope.thu=!0),"FRI"!=myEl.attr("day")&&(scope.locationSchedule.push({id:scope.generateUUID(),endTime:scope.to+scope.to_type,startTime:scope.from+scope.from_type,day:"FRI"}),scope.fri=!0),"SAT"!=myEl.attr("day")&&(scope.locationSchedule.push({id:scope.generateUUID(),endTime:scope.to+scope.to_type,startTime:scope.from+scope.from_type,day:"SAT"}),scope.sat=!0),"SUN"!=myEl.attr("day")&&(scope.locationSchedule.push({id:scope.generateUUID(),endTime:scope.to+scope.to_type,startTime:scope.from+scope.from_type,day:"SUN"}),scope.sun=!0),scope.all=!1}else scope.locationSchedule.push(data);myEl.removeAttr("day"),scope.flag=!1,scope.showPopover=!1,scope.from_type="",scope.to="",scope.to_type=""}}}}),angular.module("outingzApp").directive("timePickAdvance",["$compile","$timeout",function($compile,$timeout){return{restrict:"E",templateUrl:"../../views/timePickerAdvance.html?"+Math.random(),link:function(scope){console.log("link here"),scope.error_directive="",scope.locationSchedule=[];{var locations=[];angular.element(document.querySelector(".timerpopup"))}scope.showPopover=!1,scope.flag=!1,scope.from=9,scope.to=5,scope.period=["PM","AM"],scope.current_slot=[];{var days_pos=angular.element(document.querySelector("#days_group"));days_pos.offset(),days_pos.offset(),days_pos.offset()}scope.disb=function(day){var myEl=angular.element(document.querySelector(".timerpopup"));return myEl.attr("day")&&myEl.attr("day")==day?!1:myEl.attr("day")?!0:void 0},scope.all_days=function(){scope.all},scope.current_day="",scope.showPop=function($event,pos,day){scope.error_directive="";var checkbox=$event.target;switch(day){case"mon":scope.current_day="Monday";break;case"tue":scope.current_day="Tuesday";break;case"wed":scope.current_day="Wednesday";break;case"thu":scope.current_day="Thursday";break;case"fri":scope.current_day="Friday";break;case"sat":scope.current_day="Saturday";break;case"sun":scope.current_day="Sunday"}var myEl=angular.element(document.querySelector(".timerpopup"));myEl.attr("day")?checkbox.checked||(scope.showPopover=!1,myEl.removeAttr("day")):(myEl.attr("day",day),scope.showPopover=!0,checkbox.checked?(scope.current_slot.length<1&&scope.current_slot.push({from:9,from_type:"AM",to:5,to_type:"PM"}),$timeout(function(){var time_pos=angular.element(document.querySelector(".outertimeInfo"));console.log(time_pos.outerHeight()),scope.$apply(myEl.css("top",-(time_pos.outerHeight()+100)+"px"))},0)):(scope.showPopover=!1,scope.current_slot=[],angular.forEach(scope.locationSchedule,function(value){value.day!=myEl.attr("day")&&locations.push(value)}),scope.locationSchedule=locations,locations=[],myEl.removeAttr("day"))),console.log(JSON.stringify(scope.locationSchedule))},scope.showHover=function($event,pos,day){switch(console.log(JSON.stringify($event.target)),scope.error_directive="",day){case"mon":scope.current_day="Monday";break;case"tue":scope.current_day="Tuesday";break;case"wed":scope.current_day="Wednesday";break;case"thu":scope.current_day="Thursday";break;case"fri":scope.current_day="Friday";break;case"sat":scope.current_day="Saturday";break;case"sun":scope.current_day="Sunday"}var checkbox=$event.target,myEl=angular.element(document.querySelector(".timerpopup"));myEl.attr("day")||(scope.current_slot=[],scope.showPopover=!0,angular.forEach(scope.locationSchedule,function(value){value.day==day&&angular.forEach(value.time,function(value){scope.current_slot.push({from:value.startTime.slice(0,-2),from_type:value.startTime.slice(-2),to:value.endTime.slice(0,-2),to_type:value.endTime.slice(-2)}),$timeout(function(){var time_pos=angular.element(document.querySelector(".outertimeInfo"));console.log(time_pos.outerHeight()),scope.$apply(myEl.css("top",-(time_pos.outerHeight()+100)+"px"))},0)})}),checkbox.checked||(console.log("HELO"),scope.current_slot.length<1&&(scope.current_slot.push({from:9,from_type:"AM",to:5,to_type:"PM"}),$timeout(function(){var time_pos=angular.element(document.querySelector(".outertimeInfo"));console.log(time_pos.outerHeight()),scope.$apply(myEl.css("top",-(time_pos.outerHeight()+100)+"px"))},0))))},scope.closePop=function(obj){scope.error_directive="";var myEl=angular.element(document.querySelector(".timerpopup"));if(myEl.attr("day"))if(obj&&"close"==obj){switch(scope.showPopover=!1,myEl.attr("day")){case"mon":scope.mon=!1;break;case"tue":scope.tue=!1;break;case"wed":scope.wed=!1;break;case"thu":scope.thu=!1;break;case"fri":scope.fri=!1;break;case"sat":scope.sat=!1;break;case"sun":scope.sun=!1}myEl.removeAttr("day")}else scope.showPopover=!0;else scope.current_slot=[],scope.showPopover=!1,myEl.removeAttr("day")},scope.save_time=function(){var myEl=angular.element(document.querySelector(".timerpopup")),data={time:[],day:myEl.attr("day")};if(angular.forEach(scope.current_slot,function(value){var timeObj={startTime:value.from+value.from_type,
endTime:value.to+value.to_type};data.time.push(timeObj)}),scope.all){scope.locationSchedule=[];var data={time:[],day:myEl.attr("day")};if(angular.forEach(scope.current_slot,function(value){var timeObj={startTime:value.from+value.from_type,endTime:value.to+value.to_type};data.time.push(timeObj)}),scope.locationSchedule.push(data),"mon"!=myEl.attr("day")){var data={time:[],day:"mon"};angular.forEach(scope.current_slot,function(value){var timeObj={startTime:value.from+value.from_type,endTime:value.to+value.to_type};data.time.push(timeObj)}),scope.locationSchedule.push(data),scope.mon=!0}if("tue"!=myEl.attr("day")){var data={time:[],day:"tue"};angular.forEach(scope.current_slot,function(value){var timeObj={startTime:value.from+value.from_type,endTime:value.to+value.to_type};data.time.push(timeObj)}),scope.locationSchedule.push(data),scope.tue=!0}if("wed"!=myEl.attr("day")){var data={time:[],day:"wed"};angular.forEach(scope.current_slot,function(value){var timeObj={startTime:value.from+value.from_type,endTime:value.to+value.to_type};data.time.push(timeObj)}),scope.locationSchedule.push(data),scope.wed=!0}if("thu"!=myEl.attr("day")){var data={time:[],day:"thu"};angular.forEach(scope.current_slot,function(value){var timeObj={startTime:value.from+value.from_type,endTime:value.to+value.to_type};data.time.push(timeObj)}),scope.locationSchedule.push(data),scope.thu=!0}if("fri"!=myEl.attr("day")){var data={time:[],day:"fri"};angular.forEach(scope.current_slot,function(value){var timeObj={startTime:value.from+value.from_type,endTime:value.to+value.to_type};data.time.push(timeObj)}),scope.locationSchedule.push(data),scope.fri=!0}if("sat"!=myEl.attr("day")){var data={time:[],day:"sat"};angular.forEach(scope.current_slot,function(value){var timeObj={startTime:value.from+value.from_type,endTime:value.to+value.to_type};data.time.push(timeObj)}),scope.locationSchedule.push(data),scope.sat=!0}if("sun"!=myEl.attr("day")){var data={time:[],day:"sun"};angular.forEach(scope.current_slot,function(value){var timeObj={startTime:value.from+value.from_type,endTime:value.to+value.to_type};data.time.push(timeObj)}),scope.locationSchedule.push(data),scope.sun=!0}scope.all=!1}else scope.locationSchedule.push(data);console.log(JSON.stringify(scope.locationSchedule)),myEl.removeAttr("day"),$timeout(function(){},0),scope.flag=!1,scope.showPopover=!1,scope.from_type="",scope.to="",scope.to_type=""},scope.add_slot=function(){var myEl=angular.element(document.querySelector(".timerpopup"));scope.current_slot.push({from:9,from_type:"AM",to:5,to_type:"PM"}),$timeout(function(){var time_pos=angular.element(document.querySelector(".outertimeInfo"));console.log(time_pos.outerHeight()),scope.$apply(myEl.css("top",-(time_pos.outerHeight()+100)+"px"))},0)}}}}]);